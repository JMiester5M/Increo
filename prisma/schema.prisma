datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id                 String          @id // Firebase UID
  name               String?
  email              String?         @unique
  image              String?
  role               String          @default("user") // "user", "staff", "admin"
  expenseCategories  String[]        @default(["Food", "Transportation", "Housing", "Entertainment", "Shopping", "Healthcare", "Other"])
  financialInfo      FinancialInfo?
  goals              Goal[]
  expenses           Expense[]
  createdAt          DateTime        @default(now()) @db.Timestamptz(6)
  updatedAt          DateTime        @updatedAt @db.Timestamptz(6)
}

model FinancialInfo {
  id                      String   @id @default(cuid())
  userId                  String   @unique
  user                    User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  monthlyIncome           Float?
  incomeFrequency         String?
  monthlyRent             Float?
  propertyTax             Float?
  homeInsurance           Float?
  electricity             Float?
  water                   Float?
  gas                     Float?
  internet                Float?
  groceries               Float?
  diningOut               Float?
  carPayment              Float?
  carInsurance            Float?
  gasFuel                 Float?
  publicTransport         Float?
  healthInsurance         Float?
  medications             Float?
  medicalExpenses         Float?
  creditCards             Float?
  studentLoans            Float?
  personalLoans           Float?
  streaming               Float?
  gym                     Float?
  hobbies                 Float?
  clothing                Float?
  personalCare            Float?
  childcare               Float?
  petCare                 Float?
  otherExpenses           Float?
  surveyCompleted         Boolean  @default(false)
  createdAt               DateTime @default(now()) @db.Timestamptz(6)
  updatedAt               DateTime @updatedAt @db.Timestamptz(6)
}

model Goal {
  id            String    @id @default(cuid())
  userId        String
  user          User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  title         String
  description   String?
  targetAmount  Float
  currentAmount Float     @default(0)
  deadline      DateTime? @db.Timestamptz(6)
  completed     Boolean   @default(false)
  createdAt     DateTime  @default(now()) @db.Timestamptz(6)
  updatedAt     DateTime  @updatedAt @db.Timestamptz(6)
}

model Expense {
  id          String   @id @default(cuid())
  userId      String
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  category    String
  subcategory String?
  amount      Float
  description String?
  date        DateTime @default(now()) @db.Timestamptz(6)
  createdAt   DateTime @default(now()) @db.Timestamptz(6)
  updatedAt   DateTime @updatedAt @db.Timestamptz(6)
}
